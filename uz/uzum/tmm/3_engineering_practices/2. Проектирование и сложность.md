# Проектирование и сложность

## Ожидание от команды

1. Составить список проблемных компонентов
2. Запланировать задачи на написание недостающей документации исследованию проблемных компонентов
3. Определить роадмап по сокращению связанности сервисов/компонентов (эпик/вики любой другой документ)
4. Запланировать перенос всей логики из монолита в сервисы (артефакт - роадмап по сокращению
   присутствия в монолите) для команд, где этот пункт применим

## Пример

1. Жёсткая связанность.
2. Валидация архитектуры.
3. Bus-factor.
4. Наличие зоопарка.

## Зачем эта практика

Легко реализовать прототип по-быстрому, но если при проектировании не учесть возможность
расширения, сложность дальнейшего развития может возрастать экспоненциально. Высокий
bus factor и участие в архитектурных комитетах позволяют качественней провалидировать
архитектурные решения, избежать проблем в будущем и продуктивней работать с рефакторингом.

| Уровень 0        | Не знаем какой bus-factor по текущим сервисам команды. Команда не обсуждает изменения архитектуры ни внутренних разборах, ни на арх комитетах. Код пишется в преимущественно монолите                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
|------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| Как перейти      | - Составить список проблемных компонентов<br/>- Запланировать перенос части логики из монолита в сервисы, для команд где применимо<br/>- Запланировать задачи на написание недостающей документации исследованию проблемных компонентов<br/>- Определить роадмап по сокращению связанности сервисов/компонентов (эпик/вики любой другой документ) <br/>- Применение известных архитектурных паттернов при разработке микросервсиной архитектуры (реестр паттернов). Команда проводит аудит своих сервисов согласно реестру в направлениях, где применима                                                                                                                                                                                                                                       |
| Уровень 1        | Bus factor у большинства компонентов <= 1 (часть кода не знакома команде) Крупные изменения команда выносит на внутренние арх ревью и фиксирует договоренности. Между сервисами сильная связанность, падение одного приводит к падению остальных, невозможность переиспользования компонентов. Новая логика реализуется в сервисах                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| Как перейти      | - Провести презентации или сессии парного программирования по текущим задачам проблемных компонентов<br/>- Составить звездную карту по сервисам, начать распределять задачи между участниками команды с учетом басфактора <br/>- Обеспечена слабая связанность между сервисами. Падение одного, не приводит к падению другого, продуманы фоллбэки <br/>- Переписать наиболее критичные сервисы и проблемы согласно реестру уровня 1 обеспечить повышение bus-factor до 1+<br/> - При проектировании сервиса, команда применяет low-code, no-code решения, там где это применимо, обеспечивает управление системной в рантайме согласно запросам стейкхолдера                                                                                                                                   |
| Уровень 2 (Base) | Команда может разрабатывать и выкатывать сервисы независимо. Обеспечивает требуемый уровень гибкости сервиса согласно требованиям стейкхолдера, общие компоненты возможно использовать независимо. Большие изменения команда проводит через архитектурный комитет, локальные - через внутреннее арх ревью. Команда знакома с большей частью кодовой базы                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| Как перейти      | - Проанализировать планы юнита на следующий квартал и при необходимости запланировать большие изменения на архитектурный комитет. Задачи включены в общий продуктовый роадмап<br/>- Команда повышает bus-factor до -2<br/>- Все сервисы команды живут по Simple Flow<br/>- Команда инструментально считает сложность кода (Cognitive complexity, Cyclomatic Complexity) SonarQube и аналоги и придерживается рекомендаций<br/>- Все сервисы команды выехали из монолита (кроме законсервированных), для команд где этот пункт применим<br/>- У команды есть схемы архитектуры согласно 4C или другой модели<br/>- Команда приоритетно использует очереди, где это применимо<br/>- все сервисы переписаны согласно реестру уровня 1<br/>Cognitive Complexity =15<br/>Cyclomatic Complexity = 10 |
| Уровень 3        | Команда знает свои сервисы (приемлемый уровень bus-factor, есть описание архитектуры) знает своих чемпионов по стекам и приходит к ним за советами и на арх ревью. Команда приоритетно использует очереди там, где это возможно. Команда держит master-ветки сервисов чистыми, их можно было передеплоить в любой момент.                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
