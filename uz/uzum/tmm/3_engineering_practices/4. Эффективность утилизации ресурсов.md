# Эффективность утилизации ресурсов

## Ожидание от команды

Команда следит за эффективностью утилизации различных ресурсов, осознанно планирует рост и бюджет
на закупку железа/парка новых устройств

## Пример

Неоправданно высокое потребление CPU в пропорции на один запрос.

Огромная утилизация сети.

## Зачем эта практика

Несмотря на возможность гибкого планирования, облако не резиновое, и в нём тоже нужно следить
за эффективностью использования ресурсов. В ближайшем будущем мы планируем внедрять квоты на ресурсы
для юнитов/кластеров, и чтобы в них влезать, командам нужно осознанней подходить за потреблением ресурсов
своими сервисами. Хотим, чтобы сервисы использовали правильные подходы к изоляции данных,
эффективно утилизировали базы данных и умели корректно в production и reserve

| Уровень 0        | Команда не следит за потреблением ресурсов своими сервисами, Не пользуется парком устройств                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
|------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| Как перейти      | - Следить за ростом потребления ресурсов в Grafana или другом инструменте.<br/>- Команда не системно проводит аудит артефактов (размер докер образов/приложений)<br/>- Команда не знает максимальные нагрузки на свой сервис<br/>- Команда не системно проводит аудит БД + gbq<br/>- Составить текущий парк устройств, настроить удаленный доступ, определить подход к использованию и шерингу устройств                                                                                                                                                         |
| Уровень 1        | Команда следит за потреблением ресурсов,оптимизирует только ситуативно                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| Как перейти      | - Команда проводит нагрузочное тестирование и на основе экспериментальных данных и нагрузки на сервис выставляет целевые значения<br/>- Следит за ростом потребления ресурсов и регулярно планировать задачи на оптимизацию существующих бутылочных горлышек.<br/>- Проводит аудит использования метрик, логов и Sentry — убеждается, что без надобности не пишется access log, в Sentry и другие инструменты мониторинга отправляются только ошибки, требующие внимания разработчиков.<br/>- Команда использует ферму устройств, актуализация парка не системна |
| Уровень 2 (Base) | Команда следит за потреблением всех ресурсов и оптимизирует по запросу                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| Как перейти      | - Провести аудит использования кэша в приложении и запланировать задачи по рефакторингу хранение в памяти. Команда использует in-memory кэширование, где это применимо.<br/>- Команда актуализирует парк устройств на основе данных крешлитики. Находит пути для оптимизации через эмуляторы. Сформирован бэклог по развитию фермы, задачи системно попадают в спринты<br/>- Команда системно проводит аудит, вырабатывает экшн-поинты и планирует работы по ним                                                                                                 |
| Уровень 3        | Команда системно проводит аудит БД, превентивно оптимизирует медленные запросы                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
